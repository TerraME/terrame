<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
   "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html>
	<head>
	    
	    	<title>TerraME Types and Functions</title>
	    
	    <link rel="stylesheet" href="../luadoc.css" type="text/css" />
		<!--meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/-->
	</head>

	<body>
		<div id="container">
			<div id="product">
				<div id="product_logo">
					<a href="http://www.terrame.org">
					<img src='../img/terrame.png'/><br/></div></a>
				<div id="product_name"><big><b></b></big></div>
				<div id="product_description"></div>
			</div> <!-- id="product" -->

			<div id="main">
				<div id="navigation">
					<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
   "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">


<h1>base</h1>
<ul>
	
		<li><a href="../index.html">Index</a></li>
	
</ul>

<!-- Module list -->


<!-- Models list -->

	
	
		
	
		
	
		
	
		
	
		
	
		
	
		
	
		
	
		
	
		
	
		
	
		
	
		
	
		
	
		
	
		
	
		
	
		
	
		
	
		
	
		
	
		
	
		
	
		
	
		
	
		
	
		
	
		
	
		
	
		
	
		
	
		
	
		
	
		
	
		
	
		
	
		
	
		
	
		
	
		
	
		
	
		
	
		
	
		
	
		
	
		
	
		
	
		
	
		
	
		
	
		
	
		
	
		
	
		
	
		
	
		
	

	


<!-- Types list -->

	
	
		
			
		
	
		
			
		
	
		
			
		
	
		
			
		
	
		
			
		
	
		
			
		
	
		
			
		
	
		
			
		
	
		
	
		
			
		
	
		
	
		
			
		
	
		
			
		
	
		
			
		
	
		
			
		
	
		
			
		
	
		
			
		
	
		
			
		
	
		
			
		
	
		
			
		
	
		
	
		
			
		
	
		
			
		
	
		
			
		
	
		
			
		
	
		
			
		
	
		
			
		
	
		
			
		
	
		
			
		
	
		
	
		
			
		
	
		
	
		
	
		
	
		
	
		
	
		
	
		
	
		
	
		
	
		
	
		
	
		
	
		
	
		
	
		
	
		
	
		
	
		
	
		
	
		
	
		
	
		
	
		
	
		
	
		
	

	
		<h1>Types</h1>
	

	<ul>
		
					<li>
						<a href="../files/Agent.html">Agent</a>
					</li>
				
			
		
					<li>
						<a href="../files/Automaton.html">Automaton</a>
					</li>
				
			
		
					<li>
						<a href="../files/Cell.html">Cell</a>
					</li>
				
			
		
					<li>
						<a href="../files/CellularSpace.html">CellularSpace</a>
					</li>
				
			
		
					<li>
						<a href="../files/Chart.html">Chart</a>
					</li>
				
			
		
					<li>
						<a href="../files/Choice.html">Choice</a>
					</li>
				
			
		
					<li>
						<a href="../files/Clock.html">Clock</a>
					</li>
				
			
		
					<li>
						<a href="../files/Environment.html">Environment</a>
					</li>
				
			
		
		
					<li>
						<a href="../files/Event.html">Event</a>
					</li>
				
			
		
		
					<li>
						<a href="../files/Flow.html">Flow</a>
					</li>
				
			
		
					<li>
						<a href="../files/Group.html">Group</a>
					</li>
				
			
		
					<li>
						<a href="../files/InternetSender.html">InternetSender</a>
					</li>
				
			
		
					<li>
						<a href="../files/Jump.html">Jump</a>
					</li>
				
			
		
					<li>
						<a href="../files/LogFile.html">LogFile</a>
					</li>
				
			
		
					<li>
						<a href="../files/Mandatory.html">Mandatory</a>
					</li>
				
			
		
					<li>
						<a href="../files/Map.html">Map</a>
					</li>
				
			
		
					<li>
						<a href="../files/Model.html">Model</a>
					</li>
				
			
		
					<li>
						<a href="../files/Neighborhood.html">Neighborhood</a>
					</li>
				
			
		
		
					<li>
						<a href="../files/Random.html">Random</a>
					</li>
				
			
		
					<li>
						<a href="../files/SocialNetwork.html">SocialNetwork</a>
					</li>
				
			
		
					<li>
						<a href="../files/Society.html">Society</a>
					</li>
				
			
		
					<li>
						<a href="../files/State.html">State</a>
					</li>
				
			
		
					<li>
						<a href="../files/TextScreen.html">TextScreen</a>
					</li>
				
			
		
					<li><strong>Timer</strong></li>
				
			
		
					<li>
						<a href="../files/Trajectory.html">Trajectory</a>
					</li>
				
			
		
					<li>
						<a href="../files/UnitTest.html">UnitTest</a>
					</li>
				
			
		
		
					<li>
						<a href="../files/VisualTable.html">VisualTable</a>
					</li>
				
			
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
	</ul>


<!-- Files list -->

	
	
		
	
		
	
		
	
		
	
		
	
		
	
		
	
		
	
		
			
		
	
		
	
		
			
		
	
		
	
		
	
		
	
		
	
		
	
		
	
		
	
		
	
		
	
		
			
		
	
		
	
		
	
		
	
		
	
		
	
		
	
		
	
		
	
		
			
		
	
		
	
		
	
		
	
		
	
		
	
		
	
		
	
		
	
		
	
		
	
		
	
		
	
		
	
		
	
		
	
		
	
		
	
		
	
		
	
		
	
		
	
		
	
		
	
		
	
		
	
		
	

	
		<h1>Functions</h1>
	

	<ul>
		
		
		
		
		
		
		
		
		
					<li>
						<a href="../files/ErrorHandling.html">ErrorHandling</a>
					</li>
				
			
		
		
					<li>
						<a href="../files/FileSystem.html">FileSystem</a>
					</li>
				
			
		
		
		
		
		
		
		
		
		
		
					<li>
						<a href="../files/Package.html">Package</a>
					</li>
				
			
		
		
		
		
		
		
		
		
		
					<li>
						<a href="../files/Utils.html">Utils</a>
					</li>
				
			
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
	</ul>


<!-- Examples -->

	
		<h1><a href="../files/examples.html">Examples</a></h1>
	



<!-- Data -->

	
		<h1><a href="../files/data.html">Data</a></h1>
	



<!-- Font -->

	
		<h1><a href="../files/font.html">Font</a></h1>
	




				</div> <!-- id="navigation" -->

				<div id="content">
					<h1>Timer
					
					
					</h1>

					
						<span class="description"></span>
					
					
					
					

					
						
						<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
   "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">



<span class="description">

A Timer is an event-based scheduler that runs the simulation. It contains a set of <a href=../files/Event.html>Events</a>, allowing the simulation to work with processes that start independently and act in different periodicities. As default, it execute the Events in the order they were declared, but the arguments of Event (start, priority, and period) can change this order. Once a Timer has a given simulation time, it ensures that all the Events before that time were already executed. See <a href=../files/Timer.html#run>run()</a> for more details.</span>




<!-- Function arguments -->
  <h3>Arguments</h3>
<ul><span class="arg">

    <li>
	  <strong>round</strong>: A number to work with Events that have period less than one. It rounds the execution time of an Event that is going to be scheduled to be executed to a time in the future if the difference between such time and the closest integer number is less then the value of this argument. For example, an Event that starts in time one and has period 0.1 might execute in time 1.999999999, as we are working with real numbers. Round is then useful to make sure that such Event will be executed in time exactly two. The default value is 0.00001 (1e-5).
    </li> 
    
  
    <li>
	  <strong>...</strong>: A set of Events.
    </li> 
    
  
  </span></ul>



<!-- Outputs of the function -->
  <h3>Attributes</h3>
Some attributes of Timer have internal semantics. They can be used as <b>read-only</b> by the modeler.</p>
<ul>
<span class="output">
	
	<li>
	  <strong>cObj_</strong>: A pointer to a C++ representation of the Timer. Never use this object.
	</li>
	
	<li>
	  <strong>events</strong>: An ordered vector with the Events.
	</li>
	
	<li>
	  <strong>time</strong>: The current simulation time.
	</li>
	
</span>
</ul>





<h3>Usage</h3>
<pre class="example"><code><span class="id">timer</span> = <span class="function">Timer</span>{
    <span class="function">Event</span>{<span class="id">action</span> = <span class="reserved">function</span>()
        <span class="id">print</span>(<span class="string">"each time step"</span>)
    <span class="reserved">end</span>},
    <span class="function">Event</span>{<span class="id">period</span> = <span class="number">2</span>, <span class="id">action</span> = <span class="reserved">function</span>()
        <span class="id">print</span>(<span class="string">"each two time steps"</span>)
    <span class="reserved">end</span>},
    <span class="function">Event</span>{<span class="id">priority</span> = <span class="string">"high"</span>, <span class="id">period</span> = <span class="number">4</span>, <span class="id">action</span> = <span class="reserved">function</span>()
        <span class="id">print</span>(<span class="string">"each four time steps"</span>)
    <span class="reserved">end</span>}
}

<span class="id">timer</span>:<span class="id">run</span>(<span class="number">10</span>)</code></pre>




</dd>


						
						

						
							<h2 class="function_list">Functions</h2>
							<table class="function_list">
							
								
									<tr>
										<td class="name" nowrap><a href="#add">add</a>&nbsp;
<td class="summary">Add a new <a href=../files/Event.html>Event</a> to the timer.</td>
									</tr>
								
							
								
									<tr>
										<td class="name" nowrap><a href="#addReplacement">addReplacement</a>&nbsp;
<td class="summary">Add temporal replacements for a given attribute.</td>
									</tr>
								
							
								
									<tr>
										<td class="name" nowrap><a href="#clear">clear</a>&nbsp;
<td class="summary">Remove all the <a href=../files/Event.html>Events</a> from the Timer.</td>
									</tr>
								
							
								
									<tr>
										<td class="name" nowrap><a href="#execute">execute</a>
										<i><font color="gray"> (deprecated)</font></i>&nbsp;
<td class="summary">Run the simulation.</td>
									</tr>
								
							
								
									<tr>
										<td class="name" nowrap><a href="#getEvents">getEvents</a>&nbsp;
<td class="summary">Return a vector with the <a href=../files/Event.html>Events</a> of the Timer.</td>
									</tr>
								
							
								
									<tr>
										<td class="name" nowrap><a href="#getTime">getTime</a>&nbsp;
<td class="summary">Return the current simulation time.</td>
									</tr>
								
							
								
									<tr>
										<td class="name" nowrap><a href="#notify">notify</a>&nbsp;
<td class="summary">Notify every Observer connected to the Timer.</td>
									</tr>
								
							
								
									<tr>
										<td class="name" nowrap><a href="#reset">reset</a>&nbsp;
<td class="summary">Reset the Timer to time minus infinite, keeping the same <a href=../files/Event.html>Event</a> queue.</td>
									</tr>
								
							
								
									<tr>
										<td class="name" nowrap><a href="#run">run</a>&nbsp;
<td class="summary">Run the Timer until a given final time.</td>
									</tr>
								
							
								
									<tr>
										<td class="name" nowrap><a href="##">#</a>&nbsp;
<td class="summary">Return the number of <a href=../files/Event.html>Events</a> in the Timer.</td>
									</tr>
								
							
						
						</table>
					

					

					<!--<br/>
					<br/>-->

					
						
						<dl class="function">
							
									<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
   "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">


<dt><h2><a name="add">

	</a><strong>add</strong>&nbsp;

</h2></dt>
<dd>


<span class="description">

Add a new <a href=../files/Event.html>Event</a> to the timer. If the Event has a start time less than the current simulation time then add() will prompt a warning (but the Event will be added).</span>




<!-- Function arguments -->
  <h3>Arguments</h3>
<ul><span class="arg">

    <li>
	  <strong>#1</strong>: An Event.
    </li> 
    
  
  </span></ul>







<h3>Usage</h3>
<pre class="example"><code><span class="id">timer</span> = <span class="function">Timer</span>{}

<span class="id">timer</span>:<span class="function">add</span>(<span class="function">Event</span>{<span class="id">action</span> = <span class="reserved">function</span>() <span class="reserved">end</span>})</code></pre>




</dd>


						    	
							
									<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
   "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">


<dt><h2><a name="addReplacement">

	</a><strong>addReplacement</strong>&nbsp;

</h2></dt>
<dd>


<span class="description">

Add temporal replacements for a given attribute. <a href=../files/Cell.html>Cells</a> and <a href=../files/Agent.html>Agents</a> might have temporal data stored as attribute values, with time stored as part of the attribute name. This function adds a set of <a href=../files/Event.html>Events</a> to update a given attribute from several temporal attributes. It is particularly useful when working with data loaded from files or databases.<br><br></span>




<!-- Function arguments -->
  <h3>Arguments</h3>
<ul><span class="arg">

    <li>
	  <strong>attribute</strong>: A string with an attribute name to be updated with the temporal data.
    </li> 
    
  
    <li>
	  <strong>select</strong>: A vector of attributes that represent temporal data. This function will create one Event for each value in this vector.
    </li> 
    
  
    <li>
	  <strong>target</strong>: A <a href=../files/CellularSpace.html>CellularSpace</a> or a <a href=../files/Society.html>Society</a>.
    </li> 
    
  
    <li>
	  <strong>time</strong>: A vector of times, with the same length of select. The events will be scheduled to execute in such times with priority "veryhigh".
    </li> 
    
  
  </span></ul>







<h3>Usage</h3>
<pre class="example"><code><span class="id">c</span> = <span class="function">Cell</span>{
    <span class="id">dist</span> = <span class="number">1</span>,
    <span class="id">dist10</span> = <span class="number">2</span>,
    <span class="id">dist20</span> = <span class="number">3</span>
}

<span class="id">cs</span> = <span class="function">CellularSpace</span>{
    <span class="id">xdim</span> = <span class="number">10</span>,
    <span class="id">instance</span> = <span class="id">c</span>
}

<span class="id">timer</span> = <span class="function">Timer</span>{}

<span class="id">timer</span>:<span class="function">addReplacement</span>{
    <span class="id">target</span> = <span class="id">cs</span>,
    <span class="id">select</span> = {<span class="string">"dist10"</span>, <span class="string">"dist20"</span>},
    <span class="id">attribute</span> = <span class="string">"dist"</span>,
    <span class="id">time</span> = {<span class="number">10</span>, <span class="number">20</span>}
}

<span class="id">print</span>(<span class="id">cs</span>:<span class="id">dist</span>()) <span class="comment">-- 100</span>

<span class="id">timer</span>:<span class="id">run</span>(<span class="number">13</span>)
<span class="id">print</span>(<span class="id">cs</span>:<span class="id">dist</span>()) <span class="comment">-- 200</span>

<span class="id">timer</span>:<span class="id">run</span>(<span class="number">20</span>)
<span class="id">print</span>(<span class="id">cs</span>:<span class="id">dist</span>()) <span class="comment">-- 300</span></code></pre>




</dd>


						    	
							
									<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
   "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">


<dt><h2><a name="clear">

	</a><strong>clear</strong>&nbsp;

</h2></dt>
<dd>


<span class="description">

Remove all the <a href=../files/Event.html>Events</a> from the Timer. Note that, when this function is called within an action of an Event, if such function does not return false, it will be added to the Timer again after the end of its execution. This means that the simulation will continue with a single Event until its final time.<br><br></span>










<h3>Usage</h3>
<pre class="example"><code><span class="id">timer</span> = <span class="function">Timer</span>{
    <span class="function">Event</span>{<span class="id">action</span> = <span class="reserved">function</span>() <span class="id">print</span>(<span class="string">"step"</span>) <span class="reserved">end</span>}
}

<span class="id">timer</span>:<span class="function">clear</span>()</code></pre>




</dd>


						    	
							
									<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
   "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">


<dt><h2><a name="execute">

	
		

		</a><font color="gray">execute <i>(deprecated, use
				
				<a href="../files/Timer.html#run">run</a> 
			
		instead)</i></font>&nbsp;
	

</h2></dt>
<dd>

<font color="gray">
<span class="description">

Run the simulation.<br><br></span>










</font>


</dd>


						    	
							
									<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
   "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">


<dt><h2><a name="getEvents">

	</a><strong>getEvents</strong>&nbsp;

</h2></dt>
<dd>


<span class="description">

Return a vector with the <a href=../files/Event.html>Events</a> of the Timer.<br><br></span>










<h3>Usage</h3>
<pre class="example"><code><span class="id">timer</span> = <span class="function">Timer</span>{
    <span class="function">Event</span>{<span class="id">action</span> = <span class="reserved">function</span>() <span class="id">print</span>(<span class="string">"step"</span>) <span class="reserved">end</span>}
}

<span class="id">print</span>(<span class="id">timer</span>:<span class="function">getEvents</span>()[<span class="number">1</span>]:<span class="id">getTime</span>())</code></pre>




</dd>


						    	
							
									<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
   "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">


<dt><h2><a name="getTime">

	</a><strong>getTime</strong>&nbsp;

</h2></dt>
<dd>


<span class="description">

Return the current simulation time.<br><br></span>










<h3>Usage</h3>
<pre class="example"><code><span class="id">timer</span> = <span class="function">Timer</span>{
    <span class="function">Event</span>{<span class="id">action</span> = <span class="reserved">function</span>() <span class="id">print</span>(<span class="string">"step"</span>) <span class="reserved">end</span>}
}

<span class="id">timer</span>:<span class="id">run</span>(<span class="number">10</span>)
<span class="id">print</span>(<span class="id">timer</span>:<span class="function">getTime</span>())</code></pre>




</dd>


						    	
							
									<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
   "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">


<dt><h2><a name="notify">

	</a><strong>notify</strong>&nbsp;

</h2></dt>
<dd>


<span class="description">

Notify every Observer connected to the Timer.<br><br></span>










<h3>Usage</h3>
<pre class="example"><code><span class="id">timer</span> = <span class="function">Timer</span>{
    <span class="function">Event</span>{<span class="id">action</span> = <span class="reserved">function</span>() <span class="id">print</span>(<span class="string">"step"</span>) <span class="reserved">end</span>}
}

<span class="function">Clock</span>{<span class="id">target</span> = <span class="id">timer</span>}

<span class="id">timer</span>:<span class="id">run</span>(<span class="number">10</span>)

<span class="id">timer</span>:<span class="function">notify</span>()</code></pre>




</dd>


						    	
							
									<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
   "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">


<dt><h2><a name="reset">

	</a><strong>reset</strong>&nbsp;

</h2></dt>
<dd>


<span class="description">

Reset the Timer to time minus infinite, keeping the same <a href=../files/Event.html>Event</a> queue.<br><br></span>










<h3>Usage</h3>
<pre class="example"><code><span class="id">timer</span> = <span class="function">Timer</span>{
    <span class="function">Event</span>{<span class="id">action</span> = <span class="reserved">function</span>() <span class="id">print</span>(<span class="string">"step"</span>) <span class="reserved">end</span>}
}

<span class="function">Clock</span>{<span class="id">target</span> = <span class="id">timer</span>}

<span class="id">timer</span>:<span class="id">run</span>(<span class="number">10</span>)

<span class="id">timer</span>:<span class="function">reset</span>()
<span class="id">print</span>(<span class="id">timer</span>:<span class="id">getTime</span>())</code></pre>




</dd>


						    	
							
									<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
   "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">


<dt><h2><a name="run">

	</a><strong>run</strong>&nbsp;

</h2></dt>
<dd>


<span class="description">

Run the Timer until a given final time. It manages the <a href=../files/Event.html>Event</a> queue according to their execution times and priorities. The Event with lower time will be executed in each step. If there are two Events to be executed at the same time, it executes the one with lower priority. If both have the same priority, it executes the one that was scheuled first for that time. In order to activate an Event, the Timer executes its action, passing the Event itself as argument. If the action of the Event does not return false, the Event is scheduled to execute again according to its period. The Timer then repeats its execution again and again. It stops only when all its Events are scheduled to execute after the final time, or when there are no remaining Events.<br><br></span>




<!-- Function arguments -->
  <h3>Arguments</h3>
<ul><span class="arg">

    <li>
	  <strong>#1</strong>: A number representing the final time of the simulation. This argument is mandatory.
    </li> 
    
  
  </span></ul>







<h3>Usage</h3>
<pre class="example"><code><span class="id">timer</span> = <span class="function">Timer</span>{
    <span class="function">Event</span>{<span class="id">action</span> = <span class="reserved">function</span>() <span class="id">print</span>(<span class="string">"step"</span>) <span class="reserved">end</span>}
}

<span class="id">timer</span>:<span class="function">run</span>(<span class="number">10</span>)</code></pre>




</dd>


						    	
							
									<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
   "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">


<dt><h2><a name="#">

	</a><strong>#</strong>&nbsp;

</h2></dt>
<dd>


<span class="description">

Return the number of <a href=../files/Event.html>Events</a> in the Timer.<br><br></span>










<h3>Usage</h3>
<pre class="example"><code><span class="id">timer</span> = <span class="function">Timer</span>{
    <span class="function">Event</span>{<span class="id">action</span> = <span class="reserved">function</span>()
        <span class="id">print</span>(<span class="string">"each time step"</span>)
    <span class="reserved">end</span>},
    <span class="function">Event</span>{<span class="id">period</span> = <span class="number">2</span>, <span class="id">action</span> = <span class="reserved">function</span>()
        <span class="id">print</span>(<span class="string">"each two time steps"</span>)
    <span class="reserved">end</span>}
}

<span class="id">print</span>(<span class="function">#</span><span class="id">timer</span>)</code></pre>




</dd>


						    	
							
						</dl>
					

					

				</div> <!-- id="content" -->
			</div> <!-- id="main" -->

			<div id="about">
				<p><a href="http://validator.w3.org/check?uri=referer"><img src="http://www.w3.org/Icons/valid-xhtml10" alt="Valid XHTML 1.0!" height="31" width="88" /></a></p>
			</div> <!-- id="about" -->

		</div> <!-- id="container" -->	
	</body>
</html>

